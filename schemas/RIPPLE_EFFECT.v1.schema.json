{
  "$schema": "http://json-schema.org/draft-07/schema#",
  "title": "Ripple Effect Event Schema",
  "description": "Schema for the 5-axis Ripple Effect forensic engine - sovereign physics of propagation, extraction detection, proof-of-origin, and cycle control",
  "type": "object",
  "required": [
    "event_id",
    "timestamp",
    "origin_shard",
    "contract_address",
    "umbrella",
    "ripple_vectors"
  ],
  "properties": {
    "event_id": {
      "type": "string",
      "description": "Unique identifier for this ripple event",
      "pattern": "^RIPPLE-[0-9]{4}-[0-9A-F]{8}$"
    },
    "timestamp": {
      "type": "string",
      "format": "date-time",
      "description": "ISO 8601 timestamp of ripple activation"
    },
    "origin_shard": {
      "type": "string",
      "description": "Name of the originating shard (Zone, Healing, Gem, Ingredient, Job, etc.)"
    },
    "contract_address": {
      "type": "string",
      "pattern": "^0x[a-fA-F0-9]{40}$",
      "description": "Ethereum address of the contract that generated this ripple"
    },
    "umbrella": {
      "type": "string",
      "enum": ["SORA", "BLEU", "COSMIC", "CIVILIAN", "MILITARY"],
      "description": "Protection umbrella under which this ripple operates"
    },
    "ripple_vectors": {
      "type": "object",
      "required": ["XX", "YY", "ZZ", "TT", "WW"],
      "properties": {
        "XX": {
          "type": "object",
          "description": "XX-RIPPLE (THE CUT) - WHO ALTERED THE PATH",
          "required": ["detected_alteration", "signature", "actors"],
          "properties": {
            "detected_alteration": {
              "type": "boolean",
              "description": "Whether path alteration was detected"
            },
            "alteration_type": {
              "type": "array",
              "items": {
                "type": "string",
                "enum": [
                  "theft",
                  "tampering",
                  "rerouting",
                  "copy_attempt",
                  "forged_ownership",
                  "altered_signature",
                  "government_override"
                ]
              },
              "description": "Types of alterations detected"
            },
            "signature": {
              "type": "string",
              "description": "Cryptographic signature of the cut vector"
            },
            "actors": {
              "type": "array",
              "items": {
                "type": "object",
                "properties": {
                  "address": {
                    "type": "string"
                  },
                  "action": {
                    "type": "string"
                  },
                  "timestamp": {
                    "type": "string",
                    "format": "date-time"
                  }
                }
              },
              "description": "List of actors who interacted with this path"
            }
          }
        },
        "YY": {
          "type": "object",
          "description": "YY-RIPPLE (THE RETURN) - THE RETURN TO SOURCE",
          "required": ["return_vector", "ownership_chain", "restitution_status"],
          "properties": {
            "return_vector": {
              "type": "object",
              "properties": {
                "ownership": {
                  "type": "string",
                  "description": "Current ownership address"
                },
                "original_owner": {
                  "type": "string",
                  "description": "Original/source ownership address"
                },
                "return_path": {
                  "type": "array",
                  "items": {
                    "type": "string"
                  },
                  "description": "Path for ownership to return to source"
                }
              }
            },
            "ownership_chain": {
              "type": "array",
              "items": {
                "type": "object",
                "properties": {
                  "owner": {
                    "type": "string"
                  },
                  "timestamp": {
                    "type": "string",
                    "format": "date-time"
                  },
                  "proof_of_origin": {
                    "type": "string"
                  }
                }
              },
              "description": "Complete chain of ownership"
            },
            "restitution_status": {
              "type": "string",
              "enum": ["pending", "in_progress", "completed", "blocked"],
              "description": "Status of return to source"
            },
            "stolen_cycles_returned": {
              "type": "number",
              "description": "Number of stolen cycles that have ricocheted back to origin"
            }
          }
        },
        "ZZ": {
          "type": "object",
          "description": "ZZ-RIPPLE (THE DEPTH) - WHAT IS HIDDEN BENEATH THE SURFACE",
          "required": ["depth_scan", "hidden_layers"],
          "properties": {
            "depth_scan": {
              "type": "object",
              "properties": {
                "scan_depth": {
                  "type": "integer",
                  "description": "Number of layers scanned"
                },
                "hidden_contracts_found": {
                  "type": "integer"
                },
                "ghost_nodes_found": {
                  "type": "integer"
                }
              }
            },
            "hidden_layers": {
              "type": "array",
              "items": {
                "type": "object",
                "properties": {
                  "layer_type": {
                    "type": "string",
                    "enum": [
                      "buried_contract",
                      "hidden_tie",
                      "secret_clause",
                      "invisible_ownership_funnel",
                      "concealed_extraction_system",
                      "ghost_node",
                      "shadow_routing",
                      "silent_watcher"
                    ]
                  },
                  "layer_address": {
                    "type": "string"
                  },
                  "discovered_at": {
                    "type": "string",
                    "format": "date-time"
                  },
                  "extraction_route": {
                    "type": "array",
                    "items": {
                      "type": "string"
                    },
                    "description": "Path of hidden extraction"
                  }
                }
              },
              "description": "Detected hidden layers and structures"
            },
            "chain_theft_detected": {
              "type": "boolean",
              "description": "Whether entire system theft in chain was detected"
            }
          }
        },
        "TT": {
          "type": "object",
          "description": "TT-RIPPLE (THE TIME) - WHEN THE MOVE HAPPENED AND WHEN IT WILL HAPPEN AGAIN",
          "required": ["temporal_log", "cycle_prediction"],
          "properties": {
            "temporal_log": {
              "type": "array",
              "items": {
                "type": "object",
                "properties": {
                  "timestamp": {
                    "type": "string",
                    "format": "date-time"
                  },
                  "event_type": {
                    "type": "string"
                  },
                  "interval_from_previous": {
                    "type": "number",
                    "description": "Milliseconds since previous event"
                  }
                }
              },
              "description": "Complete temporal log of all events"
            },
            "cycle_prediction": {
              "type": "object",
              "properties": {
                "predicted_cycles": {
                  "type": "array",
                  "items": {
                    "type": "object",
                    "properties": {
                      "predicted_time": {
                        "type": "string",
                        "format": "date-time"
                      },
                      "cycle_type": {
                        "type": "string"
                      },
                      "confidence": {
                        "type": "number",
                        "minimum": 0,
                        "maximum": 1
                      }
                    }
                  }
                },
                "government_timing_patterns": {
                  "type": "array",
                  "items": {
                    "type": "string"
                  },
                  "description": "Detected government-level timing patterns"
                }
              }
            },
            "memory_weave": {
              "type": "object",
              "properties": {
                "ancestral_memory": {
                  "type": "string",
                  "description": "Preserved ancestral memory in woven form"
                },
                "memory_hash": {
                  "type": "string",
                  "description": "Hash of the woven memory for verification"
                }
              },
              "description": "TT Ripple = memory, not stored - woven"
            }
          }
        },
        "WW": {
          "type": "object",
          "description": "WW-RIPPLE (THE INTENT / WORD) - WHY THE MOVE WAS MADE",
          "required": ["intent_analysis", "authority_chain"],
          "properties": {
            "intent_analysis": {
              "type": "object",
              "properties": {
                "real_motive": {
                  "type": "string",
                  "description": "The actual motive behind the action"
                },
                "stated_reason": {
                  "type": "string",
                  "description": "The publicly stated reason"
                },
                "motive_match": {
                  "type": "boolean",
                  "description": "Whether real motive matches stated reason"
                },
                "hidden_agenda": {
                  "type": "string",
                  "description": "Any detected hidden agenda"
                }
              }
            },
            "authority_chain": {
              "type": "array",
              "items": {
                "type": "object",
                "properties": {
                  "command_level": {
                    "type": "string"
                  },
                  "authority": {
                    "type": "string"
                  },
                  "command_issued": {
                    "type": "string",
                    "format": "date-time"
                  },
                  "political_angle": {
                    "type": "string"
                  }
                }
              },
              "description": "Complete chain of command and influence"
            },
            "psychological_pattern": {
              "type": "string",
              "description": "Detected psychological pattern of actors"
            },
            "order_behind_action": {
              "type": "string",
              "description": "The ultimate order/authority behind the theft or action"
            }
          }
        }
      }
    },
    "effect": {
      "type": "array",
      "items": {
        "type": "string"
      },
      "description": "List of effects this ripple generates across the system"
    },
    "density_score": {
      "type": "number",
      "minimum": 0,
      "maximum": 100,
      "description": "Density score impact - ripples increase interlink and impact, pushing shards into Green tier (â‰¥70)"
    },
    "watchtower_entry": {
      "type": "string",
      "description": "Reference to corresponding Watchtower CSV entry"
    },
    "pulse_archive_ref": {
      "type": "string",
      "description": "Reference to Pulse Archive electromagnetic memory record"
    },
    "tribunal_proof": {
      "type": "object",
      "properties": {
        "proof_hash": {
          "type": "string"
        },
        "signature": {
          "type": "string"
        },
        "witnesses": {
          "type": "array",
          "items": {
            "type": "string"
          }
        }
      },
      "description": "Tribunal-ready proof of ripple activation and effects"
    }
  }
}
